---
layout: default
title: Business Info/Sales Application 
---
<h1>Business Info/Sales Application (<a href="https://play.google.com/store/apps/details?id=com.floatapplication">Google Play</a>)</h1>
<h2>Introduction</h2>
<p>My friend and I built an <a href="https://play.google.com/store/apps/details?id=com.floatapplication">Android application</a>
	where users can <a href="https://jcho7022.github.io/projects/float/login.jpg">login</a>, 
	<a href="https://jcho7022.github.io/projects/float/shop.jpg">open up shops</a> 
	and <a href="https://jcho7022.github.io/projects/float/shop_markers.jpg">place a marker on the map to promote</a> their business locally. 
Users can interact with other users using <a href="https://jcho7022.github.io/projects/float/messaging.jpg">in-app instant messaging</a>
and search up items using a <a href="https://jcho7022.github.io/projects/float/elastic_search.jpg">search bar that supports elastic search</a>
  or browse nearby products using <a href="https://jcho7022.github.io/projects/float/infinite_product.jpg">"infinite" product scrolling</a>. 
	More details availiable at <a href="https://play.google.com/store/apps/details?id=com.floatapplication">Google Play</a>. </p>

<h2>Demo/<a href="https://jcho7022.github.io/projects/chatbot">Detailed Messaging Demo</a></h2>
<iframe  width="980" height="660" src="https://www.youtube.com/embed/UMC1NTGTXZI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2>Backend(<a href="server_docker.png">Docker processes</a>)</h2>
<h3>Introduction</h3>
<p>The backend was bulit using Node.js Docker containers 
	following the <a href="https://microservices.io/patterns/microservices.html">microservice design pattern</a> which 
	large scale web services such as <a href="https://www.youtube.com/watch?v=CZ3wIuvmHeM">Netflix</a>, Amazon and eBay have been
	<a href="https://jcho7022.github.io/projects/float/microservice_examples.png">apdating toward in the recent years</a>.</p>
<img src="backend_diagram.jpg" alt="server_architecture" height="750px" width="750px">

<h3>Api-gateway</h3>
<ul class="Functionality">
				<li>All app requests except instant messaging requests are made to the api-gateway. The api-gateway is responsible of routing requests to the appropriate microservices</li>
				<li>Handles basic user authentication such as checking access tokens for tasks that require permission<br></li>
				<li>Maintains <a href="https://microservices.io/patterns/data/saga.html">data consistancy</a> across services: <br>
          Some app requests incorporate many services and to achieve modulation services do not communicate with each other. 
          As a result, the api-gateway is in charge of scheduling requests to multiple services. 
	  However, a request to a certain service may fail and to maintain
	  data consistancy previous requests must be reverted by the api-gateway.<br>
          For example, when a user requests for sign-up the api-gateway:
	  <br>
          1.Request to auth-service to create user
					<br>
          2.Request to user-service to create user profile
					<br>
          3.Request to chat-service to generate xmpp account
					<br><br>
		
          However, if any of these steps fail, to achieve transaction atomicity, previous requests made must be reverted. The api-gateway uses a 
					<a href="https://microservices.io/patterns/data/saga.html">“saga state machine”</a> to achieve such task and maintain data consistency over distributed services. 
          For the example above if transaction #3 fails the saga state machine reverts transaction #2 and #1.
          </li>
				</ul>
   <img src="saga_state_machine.jpg" alt="saga_state_machine" height="800px" width="800px">

  <h3>Auth-service</h3>
	<ul class="Functionality">
		<li>Stores usernames and hashed passwords using the node.js <a href="https://www.npmjs.com/package/bcrypt">Bcrypt library</a></li>
		<li>Verifies passwords and grants refresh and access tokens <br>
			<img src="auth_user_session.jpg" alt="auth_user_session" height="800px" width="800px"></li>
	</ul>

   <h3>User-service</h3>
   <p>Stores and handles requests for user data such as profile image uri, background image uri, shop ownership, name</p>
      
   <h3>Chat-service(<a href="https://jcho7022.github.io/projects/chatbot/">Demo Video And Details</a>)</h3>
      <p>The chat-service has access to the MySQL database connected to ejabberd-service(XMPP) which allows custom http requests that
      the ejabberd framework does not support. For example, unread messages and dialogs lists cannot be synced among 
      multiple devices only using XMPP, however, adding the chat service makes such features possible. Also,
      this service handles push notifications for messages when users are offline.</p>
      
   <h3>Ejabberd-service(<a href="https://jcho7022.github.io/projects/chatbot/">Demo Video And Details</a>)</h3>
      <p>A xmpp framework used to add instant messaging in the app. Enabled features are:
	    <ul class="chat_features">	  
        <li><a href="https://xmpp.org/extensions/xep-0198.html">Stream Connection</a> which allows real-time detection of user disconnection for push notifications</li>
        <li><a href="https://xmpp.org/extensions/xep-0357.html">Push Notifications</a> which allows messages to be sent to user when disconnected</li>
	<li><a href="https://xmpp.org/extensions/xep-0136.html">Message Archiving</a>, <a href="https://xmpp.org/extensions/xep-0280.html">Message Carbons</a> which allows real-time message data syncing across multiple devices</li>
	<li>TLS 1.2 encryption with a self-signed certificate(application only trusts the server)</li>	    
	</ul>

   <h3>Image-service</h3>
   <p>Stores and handles requests for image files and its permissions. Image names are stored as random MD5 hash strings.</p>

   <h3>Shop-service</h3>
   <p>Stores and handles requests for shop data such as its products, cover images</p>

   <h3>Elastic-Search-service</h3>
   <p>This service handles app search requests made from the <a href="https://jcho7022.github.io/projects/float/elastic_search.jpg">app search bar</a>
       search requests are proxied from the shop-service</p>

   <h3>Map-service</h3>
   <p>Stores and handles requests for shop locations on the map. Locations are stored and queried using mongo’s geospatial queries.</p>
    
     
   <h3>General development process using continuous integration</h3>
<font size="5.8" font-family: 'Helvetica', 'Arial', 'Sans-Serif'>
	<ol type="1">
  		<li>Implement functions in repository</li>
  		<li>Iterate unit tests and fix code until all tests pass</li>
  		<li>Create endpoint in microservice</li>
		<li>Iterate integration test for microservice and fix code until all tests pass</li>
		<li>Create endpoint at api gateway</li>
		<li>Iterate integration test for api gateway and fix code until all tests pass</li>
		<li>Create hypermedia link</li>
		<li>Connect application with server</li>
	</ol>
</font>

<h3>Integration Test Demo(<a href="https://gist.github.com/jcho7022/d425f792564fa13d1927ef3c47ebb785">Tests</a>)</h3>
<iframe width="980" height="660" src="https://www.youtube.com/embed/Dn0uajOOrVQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<br><br><br>
 <p> </p>

